import * as React from 'react';
import { ImSpinner2 } from 'react-icons/im';

import clsxm from '@/lib/clsxm';

enum ButtonVariant {
  'primary',
  'outline',
  'white-outline',
  'blue-outline',
  'gradient',
  'ghost',
  'light',
  'dark',
}

type ButtonProps = {
  isLoading?: boolean;
  variant?: keyof typeof ButtonVariant;
} & React.ComponentPropsWithRef<'button'>;

const Button = React.memo(
  React.forwardRef<HTMLButtonElement, ButtonProps>(
    (
      {
        children,
        className,
        disabled: buttonDisabled,
        isLoading,
        variant = 'primary',
        ...rest
      },
      ref
    ) => {
      const disabled = isLoading || buttonDisabled;

      return (
        <button
          ref={ref}
          type='button'
          disabled={disabled}
          className={clsxm(
            'inline-flex items-center rounded px-2 py-2 font-semibold',
            'focus:outline-none focus-visible:ring focus-visible:ring-primary-500',
            'shadow-sm',
            'transition-colors duration-75',
            'dark:hover:bg-gray-700',
            //#region  //*=========== Variants ===========
            [
              variant === 'primary' && [
                'bg-blue-500 text-white',
                'dark:bg-gray-600 dark:text-gray-300',
              ],
              variant === 'outline' && [
                'text-primary-500',
                'border border-primary-500',
                'hover:bg-primary-50 active:bg-primary-100 disabled:bg-primary-100',
              ],
              variant === 'white-outline' && [
                'bg-white text-black',
                'border border-gray-200',
                'hover:border-blue-500 active:bg-white',
                'dark:hover:border-blue-700 dark:hover:bg-white dark:hover:text-blue-500 dark:focus:bg-white dark:active:bg-white',
              ],
              variant === 'blue-outline' && [
                'bg-white text-black',
                'border border-blue-500',
                'hover:border-blue-500 active:bg-white',
                'dark:bg-white dark:hover:bg-white dark:focus:bg-white',
              ],
              variant === 'gradient' && [
                'bg-gradient-to-r from-blue-500 to-blue-500',
                'border border-blue-500 text-white',
                'hover:border-blue-600 hover:from-blue-500 hover:to-blue-700',
              ],
              variant === 'ghost' && [
                'text-primary-500',
                'shadow-none',
                'hover:bg-primary-50 active:bg-primary-100 disabled:bg-primary-100',
              ],
              variant === 'light' && [
                'bg-white text-dark ',
                'border border-gray-300',
                'hover:bg-gray-100 hover:text-dark',
                'active:bg-white/80 disabled:bg-gray-200',
              ],
              variant === 'dark' && [
                'bg-gray-900 text-white',
                'border border-gray-600',
                'hover:bg-gray-800 active:bg-gray-700 disabled:bg-gray-700',
              ],
            ],
            //#endregion  //*======== Variants ===========
            'disabled:cursor-not-allowed',
            isLoading &&
              'relative text-transparent transition-none hover:text-transparent disabled:cursor-wait dark:text-transparent',
            className
          )}
          {...rest}
        >
          {isLoading && (
            <div
              className={clsxm(
                'absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2',
                {
                  'text-white': ['primary', 'dark'].includes(variant),
                  'text-black': ['light'].includes(variant),
                  'text-primary-500': ['outline', 'ghost'].includes(variant),
                }
              )}
            >
              <ImSpinner2 className='animate-spin' />
            </div>
          )}
          {children}
        </button>
      );
    }
  )
);

export default Button;
